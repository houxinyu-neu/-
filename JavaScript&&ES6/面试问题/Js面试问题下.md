# `JavaScript`面试问题下

1. 垃圾回收机制

   计算机对内存的使用流程：分配`malloc()`，读写使用，释放`free()`。`JavaScript`无需手动回收。

   + 老版本

     + 标记清除：递归标记所有变量（翻转某位或维护引用表），将被引用的变量解除标记，清除未被标记的变量。

     + 引用计数：对变量引用计数，声明/初始化时引用次数+1，赋值时+1，当解除引用时-1。清除所有引用次数为0的变量。

       **缺点：无法清除成环的引用。**

   + `V8`新版本

     + 调用栈的垃圾回收。记录当前状态的指针直接改变指向，覆盖原有函数执行上下文。

     + 堆的垃圾回收。通过主垃圾回收器和副垃圾回收器，基于代际假说来标记活动对象和非活动对象，进行高效的垃圾回收。

       + 副垃圾回收器：新生的较小对象进行标记回收。将副垃圾回收器分成对象区域和空闲区域两部分，将对象区域进行标记清除和标记整理后，将对象赋值到空闲区域，而后翻转。若存活时间较长可实现对象晋升。

         <img src="../../../../AppData/Roaming/Typora/typora-user-images/image-20200706215721131.png" alt="image-20200706215721131" style="zoom:50%;" />

       + 主垃圾回收器：内存占用较大，基于标记清除和标记整理，对垃圾回收和内存碎片的整合。进而清理内存空间。

     + `V8`的优化：由于`JavaScript`垃圾清除会造成全停顿的页面卡顿，`V8`优化增加了辅助线程并发回收、增量标记回收的方式。

1. 闭包
2. 作用域、作用域链
3. 原型链